ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"i2c.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Core/Src/i2c.c"
  20              		.section	.text.I2C1_Init,"ax",%progbits
  21              		.align	1
  22              		.global	I2C1_Init
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	I2C1_Init:
  28              	.LFB130:
   1:Core/Src/i2c.c **** /*
   2:Core/Src/i2c.c ****  * i2c.c
   3:Core/Src/i2c.c ****  *
   4:Core/Src/i2c.c ****  *  Created on: May 21, 2023
   5:Core/Src/i2c.c ****  *      Author:  Malefetsane Lenka
   6:Core/Src/i2c.c ****  *      I2C in Blocking mode,
   7:Core/Src/i2c.c ****  *      Target device; STM32F411RE
   8:Core/Src/i2c.c ****  *
   9:Core/Src/i2c.c ****  */
  10:Core/Src/i2c.c **** #include "i2c.h"
  11:Core/Src/i2c.c **** 
  12:Core/Src/i2c.c **** /**
  13:Core/Src/i2c.c ****  * @brief Initialises I2C1 on STM32F411RE, on PB8 and PB9
  14:Core/Src/i2c.c ****  *        With Clock speed of 16MHz, 10KHz I2C Speed
  15:Core/Src/i2c.c ****  */
  16:Core/Src/i2c.c **** void I2C1_Init(void){
  29              		.loc 1 16 21 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  17:Core/Src/i2c.c **** 	//Enable Clock for GPIOB
  18:Core/Src/i2c.c **** 	RCC -> AHB1ENR |= RCC_AHB1ENR_GPIOBEN;
  34              		.loc 1 18 2 view .LVU1
  35              		.loc 1 18 6 is_stmt 0 view .LVU2
  36 0000 184A     		ldr	r2, .L2
  37 0002 136B     		ldr	r3, [r2, #48]
  38              		.loc 1 18 17 view .LVU3
  39 0004 43F00203 		orr	r3, r3, #2
  40 0008 1363     		str	r3, [r2, #48]
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 2


  19:Core/Src/i2c.c **** 
  20:Core/Src/i2c.c **** 	// Alternate Function Mode for PB8 and PB9
  21:Core/Src/i2c.c **** 	GPIOB -> MODER |= (0xA <<16); // 10, AF
  41              		.loc 1 21 2 is_stmt 1 view .LVU4
  42              		.loc 1 21 8 is_stmt 0 view .LVU5
  43 000a 174B     		ldr	r3, .L2+4
  44 000c 1968     		ldr	r1, [r3]
  45              		.loc 1 21 17 view .LVU6
  46 000e 41F42021 		orr	r1, r1, #655360
  47 0012 1960     		str	r1, [r3]
  22:Core/Src/i2c.c **** 
  23:Core/Src/i2c.c **** 	//PULL UP
  24:Core/Src/i2c.c **** 
  25:Core/Src/i2c.c **** 	//GPIOB -> PUPDR |= (0x55<<16);
  26:Core/Src/i2c.c **** 
  27:Core/Src/i2c.c **** 	// OUTPUT OPEN DRAIN MODE FOR PB8  and PB9
  28:Core/Src/i2c.c **** 	GPIOB -> OTYPER |= (0x0003<<8); //Set bit and 9 high
  48              		.loc 1 28 2 is_stmt 1 view .LVU7
  49              		.loc 1 28 8 is_stmt 0 view .LVU8
  50 0014 5968     		ldr	r1, [r3, #4]
  51              		.loc 1 28 18 view .LVU9
  52 0016 41F44071 		orr	r1, r1, #768
  53 001a 5960     		str	r1, [r3, #4]
  29:Core/Src/i2c.c **** 
  30:Core/Src/i2c.c **** 	//Set the Pins to HIGH Speed Mode
  31:Core/Src/i2c.c **** 
  32:Core/Src/i2c.c **** 	GPIOB -> OSPEEDR |= (0xA<<16); //11 high Speed Mode
  54              		.loc 1 32 2 is_stmt 1 view .LVU10
  55              		.loc 1 32 8 is_stmt 0 view .LVU11
  56 001c 9968     		ldr	r1, [r3, #8]
  57              		.loc 1 32 19 view .LVU12
  58 001e 41F42021 		orr	r1, r1, #655360
  59 0022 9960     		str	r1, [r3, #8]
  33:Core/Src/i2c.c **** 
  34:Core/Src/i2c.c **** 	//I2C1 is Connected to AF4
  35:Core/Src/i2c.c **** 	//We will need Alternate Function High Register for PB8 and PB9
  36:Core/Src/i2c.c **** 	GPIOB -> AFR[1] |= 0x0044;  //0b0100 , AF4
  60              		.loc 1 36 2 is_stmt 1 view .LVU13
  61              		.loc 1 36 14 is_stmt 0 view .LVU14
  62 0024 596A     		ldr	r1, [r3, #36]
  63              		.loc 1 36 18 view .LVU15
  64 0026 41F04401 		orr	r1, r1, #68
  65 002a 5962     		str	r1, [r3, #36]
  37:Core/Src/i2c.c **** 
  38:Core/Src/i2c.c **** 	//ENABLE CLOCK FOR I2C1
  39:Core/Src/i2c.c **** 	RCC -> APB1ENR |= RCC_APB1ENR_I2C1EN;
  66              		.loc 1 39 2 is_stmt 1 view .LVU16
  67              		.loc 1 39 6 is_stmt 0 view .LVU17
  68 002c 136C     		ldr	r3, [r2, #64]
  69              		.loc 1 39 17 view .LVU18
  70 002e 43F40013 		orr	r3, r3, #2097152
  71 0032 1364     		str	r3, [r2, #64]
  40:Core/Src/i2c.c **** 
  41:Core/Src/i2c.c **** 	// Reset I2C
  42:Core/Src/i2c.c **** 	I2C1 -> CR1 |= I2C_CR1_SWRST;
  72              		.loc 1 42 2 is_stmt 1 view .LVU19
  73              		.loc 1 42 7 is_stmt 0 view .LVU20
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 3


  74 0034 0D4B     		ldr	r3, .L2+8
  75 0036 1A68     		ldr	r2, [r3]
  76              		.loc 1 42 14 view .LVU21
  77 0038 42F40042 		orr	r2, r2, #32768
  78 003c 1A60     		str	r2, [r3]
  43:Core/Src/i2c.c **** 	// Unreset it
  44:Core/Src/i2c.c **** 	I2C1 -> CR1 &= ~(I2C_CR1_SWRST);
  79              		.loc 1 44 2 is_stmt 1 view .LVU22
  80              		.loc 1 44 7 is_stmt 0 view .LVU23
  81 003e 1A68     		ldr	r2, [r3]
  82              		.loc 1 44 14 view .LVU24
  83 0040 22F40042 		bic	r2, r2, #32768
  84 0044 1A60     		str	r2, [r3]
  45:Core/Src/i2c.c **** 	// Peripheral Clock Frequency
  46:Core/Src/i2c.c **** 	I2C1 -> CR2 |= 0x10; //	16MHz
  85              		.loc 1 46 2 is_stmt 1 view .LVU25
  86              		.loc 1 46 7 is_stmt 0 view .LVU26
  87 0046 5A68     		ldr	r2, [r3, #4]
  88              		.loc 1 46 14 view .LVU27
  89 0048 42F01002 		orr	r2, r2, #16
  90 004c 5A60     		str	r2, [r3, #4]
  47:Core/Src/i2c.c **** 
  48:Core/Src/i2c.c ****     //  Configure the clock control registers
  49:Core/Src/i2c.c **** 	// T_high = CCR * T_PCLK1
  50:Core/Src/i2c.c **** 	// T_PCLK1 = 1/8MHz=125ns
  51:Core/Src/i2c.c **** 	// Standard Mode; 100kHZ
  52:Core/Src/i2c.c **** 	// 50% duty cycle; T_high = T/2
  53:Core/Src/i2c.c **** 	// T=1/100kHz = 100us
  54:Core/Src/i2c.c **** 	// T_high = 5us
  55:Core/Src/i2c.c **** 	// CCR = 5us/125ns = 40 => 0x21h
  56:Core/Src/i2c.c **** 	I2C1 -> CCR |= 0x320;
  91              		.loc 1 56 2 is_stmt 1 view .LVU28
  92              		.loc 1 56 7 is_stmt 0 view .LVU29
  93 004e DA69     		ldr	r2, [r3, #28]
  94              		.loc 1 56 14 view .LVU30
  95 0050 42F44872 		orr	r2, r2, #800
  96 0054 DA61     		str	r2, [r3, #28]
  57:Core/Src/i2c.c **** 
  58:Core/Src/i2c.c **** 
  59:Core/Src/i2c.c **** 	// Configure the rise time register
  60:Core/Src/i2c.c **** 	// TRISE = tr/T_PCLK+1 = 1000ns/125ns + 1 = 9
  61:Core/Src/i2c.c **** 	I2C1 -> TRISE = 0x11;
  97              		.loc 1 61 2 is_stmt 1 view .LVU31
  98              		.loc 1 61 16 is_stmt 0 view .LVU32
  99 0056 1122     		movs	r2, #17
 100 0058 1A62     		str	r2, [r3, #32]
  62:Core/Src/i2c.c **** 
  63:Core/Src/i2c.c **** 	//Enable the Peripheral
  64:Core/Src/i2c.c **** 	//I2C1 -> CR1 |= I2C_CR1_NOSTRETCH;
  65:Core/Src/i2c.c **** 	I2C1 -> CR1 |= I2C_CR1_PE;
 101              		.loc 1 65 2 is_stmt 1 view .LVU33
 102              		.loc 1 65 7 is_stmt 0 view .LVU34
 103 005a 1A68     		ldr	r2, [r3]
 104              		.loc 1 65 14 view .LVU35
 105 005c 42F00102 		orr	r2, r2, #1
 106 0060 1A60     		str	r2, [r3]
  66:Core/Src/i2c.c **** 
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 4


  67:Core/Src/i2c.c **** }
 107              		.loc 1 67 1 view .LVU36
 108 0062 7047     		bx	lr
 109              	.L3:
 110              		.align	2
 111              	.L2:
 112 0064 00380240 		.word	1073887232
 113 0068 00040240 		.word	1073873920
 114 006c 00540040 		.word	1073763328
 115              		.cfi_endproc
 116              	.LFE130:
 118              		.section	.text.I2C1_Start,"ax",%progbits
 119              		.align	1
 120              		.global	I2C1_Start
 121              		.syntax unified
 122              		.thumb
 123              		.thumb_func
 125              	I2C1_Start:
 126              	.LFB131:
  68:Core/Src/i2c.c **** 
  69:Core/Src/i2c.c **** /**
  70:Core/Src/i2c.c ****  * @brief Generates Start Condition
  71:Core/Src/i2c.c ****  *        
  72:Core/Src/i2c.c ****  */
  73:Core/Src/i2c.c **** void I2C1_Start(void){
 127              		.loc 1 73 22 is_stmt 1 view -0
 128              		.cfi_startproc
 129              		@ args = 0, pretend = 0, frame = 8
 130              		@ frame_needed = 0, uses_anonymous_args = 0
 131              		@ link register save eliminated.
 132 0000 82B0     		sub	sp, sp, #8
 133              		.cfi_def_cfa_offset 8
  74:Core/Src/i2c.c **** 	volatile uint16_t temp;
 134              		.loc 1 74 2 view .LVU38
  75:Core/Src/i2c.c **** 	I2C1 -> CR1 |= I2C_CR1_START; //Set Start Condition
 135              		.loc 1 75 2 view .LVU39
 136              		.loc 1 75 7 is_stmt 0 view .LVU40
 137 0002 084A     		ldr	r2, .L7
 138 0004 1368     		ldr	r3, [r2]
 139              		.loc 1 75 14 view .LVU41
 140 0006 43F48073 		orr	r3, r3, #256
 141 000a 1360     		str	r3, [r2]
  76:Core/Src/i2c.c **** 	while(!(I2C1->SR1 & I2C_SR1_SB));  //Wait Until  Start Bit is Generated
 142              		.loc 1 76 2 is_stmt 1 view .LVU42
 143              	.L5:
 144              		.loc 1 76 8 discriminator 1 view .LVU43
 145              		.loc 1 76 14 is_stmt 0 discriminator 1 view .LVU44
 146 000c 054B     		ldr	r3, .L7
 147 000e 5B69     		ldr	r3, [r3, #20]
 148              		.loc 1 76 8 discriminator 1 view .LVU45
 149 0010 13F0010F 		tst	r3, #1
 150 0014 FAD0     		beq	.L5
  77:Core/Src/i2c.c **** 
  78:Core/Src/i2c.c **** 	temp = I2C1 -> SR1;  // Read Status Register to Clear SB BIT
 151              		.loc 1 78 2 is_stmt 1 view .LVU46
 152              		.loc 1 78 14 is_stmt 0 view .LVU47
 153 0016 034B     		ldr	r3, .L7
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 5


 154 0018 5B69     		ldr	r3, [r3, #20]
 155              		.loc 1 78 7 view .LVU48
 156 001a 9BB2     		uxth	r3, r3
 157 001c ADF80630 		strh	r3, [sp, #6]	@ movhi
  79:Core/Src/i2c.c **** 
  80:Core/Src/i2c.c **** 
  81:Core/Src/i2c.c **** }
 158              		.loc 1 81 1 view .LVU49
 159 0020 02B0     		add	sp, sp, #8
 160              		.cfi_def_cfa_offset 0
 161              		@ sp needed
 162 0022 7047     		bx	lr
 163              	.L8:
 164              		.align	2
 165              	.L7:
 166 0024 00540040 		.word	1073763328
 167              		.cfi_endproc
 168              	.LFE131:
 170              		.section	.text.I2C_Address,"ax",%progbits
 171              		.align	1
 172              		.global	I2C_Address
 173              		.syntax unified
 174              		.thumb
 175              		.thumb_func
 177              	I2C_Address:
 178              	.LVL0:
 179              	.LFB132:
  82:Core/Src/i2c.c **** void I2C_Address(uint8_t address){
 180              		.loc 1 82 34 is_stmt 1 view -0
 181              		.cfi_startproc
 182              		@ args = 0, pretend = 0, frame = 8
 183              		@ frame_needed = 0, uses_anonymous_args = 0
 184              		@ link register save eliminated.
 185              		.loc 1 82 34 is_stmt 0 view .LVU51
 186 0000 82B0     		sub	sp, sp, #8
 187              		.cfi_def_cfa_offset 8
  83:Core/Src/i2c.c **** 	volatile uint16_t temp;
 188              		.loc 1 83 2 is_stmt 1 view .LVU52
  84:Core/Src/i2c.c **** 	I2C1-> CR1 |= I2C_CR1_ACK;  // Aknowledge
 189              		.loc 1 84 2 view .LVU53
 190              		.loc 1 84 6 is_stmt 0 view .LVU54
 191 0002 0A4B     		ldr	r3, .L12
 192 0004 1A68     		ldr	r2, [r3]
 193              		.loc 1 84 13 view .LVU55
 194 0006 42F48062 		orr	r2, r2, #1024
 195 000a 1A60     		str	r2, [r3]
  85:Core/Src/i2c.c **** 	I2C1-> DR = address ;   //Either from Read/Write function its already left shifted
 196              		.loc 1 85 2 is_stmt 1 view .LVU56
 197              		.loc 1 85 12 is_stmt 0 view .LVU57
 198 000c 1861     		str	r0, [r3, #16]
  86:Core/Src/i2c.c **** 	while (!(I2C1->SR1 & I2C_SR1_ADDR));  //Successful Address sent
 199              		.loc 1 86 2 is_stmt 1 view .LVU58
 200              	.L10:
 201              		.loc 1 86 9 discriminator 1 view .LVU59
 202              		.loc 1 86 15 is_stmt 0 discriminator 1 view .LVU60
 203 000e 074B     		ldr	r3, .L12
 204 0010 5B69     		ldr	r3, [r3, #20]
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 6


 205              		.loc 1 86 9 discriminator 1 view .LVU61
 206 0012 13F0020F 		tst	r3, #2
 207 0016 FAD0     		beq	.L10
  87:Core/Src/i2c.c **** 	temp =  I2C1->SR1 | I2C1-> SR2;
 208              		.loc 1 87 2 is_stmt 1 view .LVU62
 209              		.loc 1 87 14 is_stmt 0 view .LVU63
 210 0018 044A     		ldr	r2, .L12
 211 001a 5369     		ldr	r3, [r2, #20]
 212              		.loc 1 87 26 view .LVU64
 213 001c 9269     		ldr	r2, [r2, #24]
 214              		.loc 1 87 20 view .LVU65
 215 001e 1343     		orrs	r3, r3, r2
 216 0020 9BB2     		uxth	r3, r3
 217              		.loc 1 87 7 view .LVU66
 218 0022 ADF80630 		strh	r3, [sp, #6]	@ movhi
  88:Core/Src/i2c.c **** 
  89:Core/Src/i2c.c **** 
  90:Core/Src/i2c.c **** }
 219              		.loc 1 90 1 view .LVU67
 220 0026 02B0     		add	sp, sp, #8
 221              		.cfi_def_cfa_offset 0
 222              		@ sp needed
 223 0028 7047     		bx	lr
 224              	.L13:
 225 002a 00BF     		.align	2
 226              	.L12:
 227 002c 00540040 		.word	1073763328
 228              		.cfi_endproc
 229              	.LFE132:
 231              		.section	.text.I2C_Stop,"ax",%progbits
 232              		.align	1
 233              		.global	I2C_Stop
 234              		.syntax unified
 235              		.thumb
 236              		.thumb_func
 238              	I2C_Stop:
 239              	.LFB135:
  91:Core/Src/i2c.c **** void I2C_Master_Transmit(uint8_t address,uint8_t *pData,uint16_t Size){
  92:Core/Src/i2c.c **** 	uint16_t rem = Size;
  93:Core/Src/i2c.c **** 	I2C1_Start();  //Start Condition
  94:Core/Src/i2c.c **** 
  95:Core/Src/i2c.c **** 	I2C_Address(address<<1); //Write Condition
  96:Core/Src/i2c.c **** 	while (rem){
  97:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_TXE)); //Wait for Data Register to be empty
  98:Core/Src/i2c.c **** 		
  99:Core/Src/i2c.c **** 		I2C1 -> DR = pData[Size-rem];       //Write to Data Rgister
 100:Core/Src/i2c.c **** 		
 101:Core/Src/i2c.c **** 		rem--;
 102:Core/Src/i2c.c **** 
 103:Core/Src/i2c.c **** 
 104:Core/Src/i2c.c **** 
 105:Core/Src/i2c.c **** 	}
 106:Core/Src/i2c.c **** 	//while (!(I2C1->SR1 & I2C_SR1_BTF)); //wait until BTF is set
 107:Core/Src/i2c.c **** 	I2C_Stop();
 108:Core/Src/i2c.c **** 
 109:Core/Src/i2c.c **** 
 110:Core/Src/i2c.c **** 
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 7


 111:Core/Src/i2c.c **** 
 112:Core/Src/i2c.c **** }
 113:Core/Src/i2c.c **** void I2C_Master_Recieve(uint8_t address,uint8_t *pData,uint16_t Size){
 114:Core/Src/i2c.c **** 	volatile uint16_t temp;
 115:Core/Src/i2c.c **** 	I2C1_Start();  //Start Condition
 116:Core/Src/i2c.c **** 
 117:Core/Src/i2c.c **** 	uint16_t rem = Size;
 118:Core/Src/i2c.c **** 	if (Size==1){
 119:Core/Src/i2c.c **** 		I2C1-> DR = (address<<1 | 0x01); //Sent address with 1 to indicate r
 120:Core/Src/i2c.c **** 
 121:Core/Src/i2c.c **** 
 122:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_ADDR));  //Successful Address sent
 123:Core/Src/i2c.c **** 
 124:Core/Src/i2c.c **** 		I2C1 -> CR1 &= ~(I2C_CR1_ACK);  //Sent NACK
 125:Core/Src/i2c.c **** 
 126:Core/Src/i2c.c **** 		temp = I2C1-> SR1; //Read SR1 to clear ADDR bit
 127:Core/Src/i2c.c **** 		temp = I2C1-> SR2;  //Read SR2 to clear ADDR bit
 128:Core/Src/i2c.c **** 
 129:Core/Src/i2c.c **** 		I2C_Stop();
 130:Core/Src/i2c.c **** 
 131:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_RXNE)); //Wait until Recive buffer is not empty
 132:Core/Src/i2c.c **** 
 133:Core/Src/i2c.c **** 		pData[Size-rem] = I2C1->DR; // Load data to recieving array
 134:Core/Src/i2c.c **** 
 135:Core/Src/i2c.c **** 
 136:Core/Src/i2c.c **** 	}
 137:Core/Src/i2c.c **** 	else {
 138:Core/Src/i2c.c **** 		I2C_Address(address <<1 | 0x01);
 139:Core/Src/i2c.c **** 
 140:Core/Src/i2c.c **** 		while (rem > 3){
 141:Core/Src/i2c.c **** 			HAL_Delay(100);
 142:Core/Src/i2c.c **** 			while (!(I2C1->SR1 & I2C_SR1_RXNE)); //wait until RXNE is set
 143:Core/Src/i2c.c **** 			
 144:Core/Src/i2c.c **** 			pData[Size-rem] = I2C1->DR; // Load data to recieving array
 145:Core/Src/i2c.c **** 			I2C1-> CR1 |= I2C_CR1_ACK;  // Aknowledge
 146:Core/Src/i2c.c **** 			rem--;
 147:Core/Src/i2c.c **** 
 148:Core/Src/i2c.c **** 
 149:Core/Src/i2c.c **** 		}
 150:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_BTF)); //wait until BTF is set
 151:Core/Src/i2c.c **** 		I2C1 -> CR1 &= ~(I2C_CR1_ACK);  // Sent a NACK
 152:Core/Src/i2c.c **** 
 153:Core/Src/i2c.c **** 		pData[Size-rem] = I2C1->DR; // Load data to recieving array
 154:Core/Src/i2c.c **** 		rem--;
 155:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_BTF)); //wait until BTF is set
 156:Core/Src/i2c.c **** 		I2C_Stop();
 157:Core/Src/i2c.c **** 
 158:Core/Src/i2c.c **** 		pData[Size-rem] = I2C1->DR; // Load data to recieving array
 159:Core/Src/i2c.c **** 
 160:Core/Src/i2c.c **** 		rem--;
 161:Core/Src/i2c.c **** 		// Read Last Byte
 162:Core/Src/i2c.c **** 
 163:Core/Src/i2c.c **** 		pData[Size-rem] = I2C1->DR; // Load data to recieving array
 164:Core/Src/i2c.c **** 
 165:Core/Src/i2c.c **** 
 166:Core/Src/i2c.c **** 	}
 167:Core/Src/i2c.c **** 
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 8


 168:Core/Src/i2c.c **** }
 169:Core/Src/i2c.c **** void I2C_Stop(void){
 240              		.loc 1 169 20 is_stmt 1 view -0
 241              		.cfi_startproc
 242              		@ args = 0, pretend = 0, frame = 0
 243              		@ frame_needed = 0, uses_anonymous_args = 0
 244              		@ link register save eliminated.
 170:Core/Src/i2c.c **** 	I2C1 -> CR1 |= I2C_CR1_STOP;
 245              		.loc 1 170 2 view .LVU69
 246              		.loc 1 170 7 is_stmt 0 view .LVU70
 247 0000 024A     		ldr	r2, .L15
 248 0002 1368     		ldr	r3, [r2]
 249              		.loc 1 170 14 view .LVU71
 250 0004 43F40073 		orr	r3, r3, #512
 251 0008 1360     		str	r3, [r2]
 171:Core/Src/i2c.c **** 
 172:Core/Src/i2c.c **** 
 173:Core/Src/i2c.c **** }
 252              		.loc 1 173 1 view .LVU72
 253 000a 7047     		bx	lr
 254              	.L16:
 255              		.align	2
 256              	.L15:
 257 000c 00540040 		.word	1073763328
 258              		.cfi_endproc
 259              	.LFE135:
 261              		.section	.text.I2C_Master_Transmit,"ax",%progbits
 262              		.align	1
 263              		.global	I2C_Master_Transmit
 264              		.syntax unified
 265              		.thumb
 266              		.thumb_func
 268              	I2C_Master_Transmit:
 269              	.LVL1:
 270              	.LFB133:
  91:Core/Src/i2c.c **** 	uint16_t rem = Size;
 271              		.loc 1 91 71 is_stmt 1 view -0
 272              		.cfi_startproc
 273              		@ args = 0, pretend = 0, frame = 0
 274              		@ frame_needed = 0, uses_anonymous_args = 0
  91:Core/Src/i2c.c **** 	uint16_t rem = Size;
 275              		.loc 1 91 71 is_stmt 0 view .LVU74
 276 0000 70B5     		push	{r4, r5, r6, lr}
 277              		.cfi_def_cfa_offset 16
 278              		.cfi_offset 4, -16
 279              		.cfi_offset 5, -12
 280              		.cfi_offset 6, -8
 281              		.cfi_offset 14, -4
 282 0002 0646     		mov	r6, r0
 283 0004 0D46     		mov	r5, r1
 284 0006 1446     		mov	r4, r2
  92:Core/Src/i2c.c **** 	I2C1_Start();  //Start Condition
 285              		.loc 1 92 2 is_stmt 1 view .LVU75
 286              	.LVL2:
  93:Core/Src/i2c.c **** 
 287              		.loc 1 93 2 view .LVU76
 288 0008 FFF7FEFF 		bl	I2C1_Start
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 9


 289              	.LVL3:
  95:Core/Src/i2c.c **** 	while (rem){
 290              		.loc 1 95 2 view .LVU77
 291 000c 7000     		lsls	r0, r6, #1
 292 000e 00F0FE00 		and	r0, r0, #254
 293 0012 FFF7FEFF 		bl	I2C_Address
 294              	.LVL4:
  96:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_TXE)); //Wait for Data Register to be empty
 295              		.loc 1 96 2 view .LVU78
  92:Core/Src/i2c.c **** 	I2C1_Start();  //Start Condition
 296              		.loc 1 92 11 is_stmt 0 view .LVU79
 297 0016 2046     		mov	r0, r4
  96:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_TXE)); //Wait for Data Register to be empty
 298              		.loc 1 96 8 view .LVU80
 299 0018 0AE0     		b	.L18
 300              	.LVL5:
 301              	.L19:
  97:Core/Src/i2c.c **** 		
 302              		.loc 1 97 10 is_stmt 1 discriminator 1 view .LVU81
  97:Core/Src/i2c.c **** 		
 303              		.loc 1 97 16 is_stmt 0 discriminator 1 view .LVU82
 304 001a 084B     		ldr	r3, .L21
 305 001c 5B69     		ldr	r3, [r3, #20]
  97:Core/Src/i2c.c **** 		
 306              		.loc 1 97 10 discriminator 1 view .LVU83
 307 001e 13F0800F 		tst	r3, #128
 308 0022 FAD0     		beq	.L19
  99:Core/Src/i2c.c **** 		
 309              		.loc 1 99 3 is_stmt 1 view .LVU84
  99:Core/Src/i2c.c **** 		
 310              		.loc 1 99 26 is_stmt 0 view .LVU85
 311 0024 231A     		subs	r3, r4, r0
  99:Core/Src/i2c.c **** 		
 312              		.loc 1 99 21 view .LVU86
 313 0026 EA5C     		ldrb	r2, [r5, r3]	@ zero_extendqisi2
  99:Core/Src/i2c.c **** 		
 314              		.loc 1 99 14 view .LVU87
 315 0028 044B     		ldr	r3, .L21
 316 002a 1A61     		str	r2, [r3, #16]
 101:Core/Src/i2c.c **** 
 317              		.loc 1 101 3 is_stmt 1 view .LVU88
 101:Core/Src/i2c.c **** 
 318              		.loc 1 101 6 is_stmt 0 view .LVU89
 319 002c 0138     		subs	r0, r0, #1
 320              	.LVL6:
 101:Core/Src/i2c.c **** 
 321              		.loc 1 101 6 view .LVU90
 322 002e 80B2     		uxth	r0, r0
 323              	.LVL7:
 324              	.L18:
  96:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_TXE)); //Wait for Data Register to be empty
 325              		.loc 1 96 9 is_stmt 1 view .LVU91
 326 0030 0028     		cmp	r0, #0
 327 0032 F2D1     		bne	.L19
 107:Core/Src/i2c.c **** 
 328              		.loc 1 107 2 view .LVU92
 329 0034 FFF7FEFF 		bl	I2C_Stop
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 10


 330              	.LVL8:
 112:Core/Src/i2c.c **** void I2C_Master_Recieve(uint8_t address,uint8_t *pData,uint16_t Size){
 331              		.loc 1 112 1 is_stmt 0 view .LVU93
 332 0038 70BD     		pop	{r4, r5, r6, pc}
 333              	.LVL9:
 334              	.L22:
 112:Core/Src/i2c.c **** void I2C_Master_Recieve(uint8_t address,uint8_t *pData,uint16_t Size){
 335              		.loc 1 112 1 view .LVU94
 336 003a 00BF     		.align	2
 337              	.L21:
 338 003c 00540040 		.word	1073763328
 339              		.cfi_endproc
 340              	.LFE133:
 342              		.section	.text.I2C_Master_Recieve,"ax",%progbits
 343              		.align	1
 344              		.global	I2C_Master_Recieve
 345              		.syntax unified
 346              		.thumb
 347              		.thumb_func
 349              	I2C_Master_Recieve:
 350              	.LVL10:
 351              	.LFB134:
 113:Core/Src/i2c.c **** 	volatile uint16_t temp;
 352              		.loc 1 113 70 is_stmt 1 view -0
 353              		.cfi_startproc
 354              		@ args = 0, pretend = 0, frame = 8
 355              		@ frame_needed = 0, uses_anonymous_args = 0
 113:Core/Src/i2c.c **** 	volatile uint16_t temp;
 356              		.loc 1 113 70 is_stmt 0 view .LVU96
 357 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 358              		.cfi_def_cfa_offset 20
 359              		.cfi_offset 4, -20
 360              		.cfi_offset 5, -16
 361              		.cfi_offset 6, -12
 362              		.cfi_offset 7, -8
 363              		.cfi_offset 14, -4
 364 0002 83B0     		sub	sp, sp, #12
 365              		.cfi_def_cfa_offset 32
 366 0004 0446     		mov	r4, r0
 367 0006 0E46     		mov	r6, r1
 368 0008 1546     		mov	r5, r2
 114:Core/Src/i2c.c **** 	I2C1_Start();  //Start Condition
 369              		.loc 1 114 2 is_stmt 1 view .LVU97
 115:Core/Src/i2c.c **** 
 370              		.loc 1 115 2 view .LVU98
 371 000a FFF7FEFF 		bl	I2C1_Start
 372              	.LVL11:
 117:Core/Src/i2c.c **** 	if (Size==1){
 373              		.loc 1 117 2 view .LVU99
 118:Core/Src/i2c.c **** 		I2C1-> DR = (address<<1 | 0x01); //Sent address with 1 to indicate r
 374              		.loc 1 118 2 view .LVU100
 118:Core/Src/i2c.c **** 		I2C1-> DR = (address<<1 | 0x01); //Sent address with 1 to indicate r
 375              		.loc 1 118 5 is_stmt 0 view .LVU101
 376 000e 012D     		cmp	r5, #1
 377 0010 22D1     		bne	.L24
 119:Core/Src/i2c.c **** 
 378              		.loc 1 119 3 is_stmt 1 view .LVU102
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 11


 119:Core/Src/i2c.c **** 
 379              		.loc 1 119 23 is_stmt 0 view .LVU103
 380 0012 6300     		lsls	r3, r4, #1
 119:Core/Src/i2c.c **** 
 381              		.loc 1 119 27 view .LVU104
 382 0014 43F00103 		orr	r3, r3, #1
 119:Core/Src/i2c.c **** 
 383              		.loc 1 119 13 view .LVU105
 384 0018 2D4A     		ldr	r2, .L34
 385 001a 1361     		str	r3, [r2, #16]
 122:Core/Src/i2c.c **** 
 386              		.loc 1 122 3 is_stmt 1 view .LVU106
 387              	.L25:
 122:Core/Src/i2c.c **** 
 388              		.loc 1 122 10 discriminator 1 view .LVU107
 122:Core/Src/i2c.c **** 
 389              		.loc 1 122 16 is_stmt 0 discriminator 1 view .LVU108
 390 001c 2C4B     		ldr	r3, .L34
 391 001e 5B69     		ldr	r3, [r3, #20]
 122:Core/Src/i2c.c **** 
 392              		.loc 1 122 10 discriminator 1 view .LVU109
 393 0020 13F0020F 		tst	r3, #2
 394 0024 FAD0     		beq	.L25
 124:Core/Src/i2c.c **** 
 395              		.loc 1 124 3 is_stmt 1 view .LVU110
 124:Core/Src/i2c.c **** 
 396              		.loc 1 124 8 is_stmt 0 view .LVU111
 397 0026 2A4B     		ldr	r3, .L34
 398 0028 1A68     		ldr	r2, [r3]
 124:Core/Src/i2c.c **** 
 399              		.loc 1 124 15 view .LVU112
 400 002a 22F48062 		bic	r2, r2, #1024
 401 002e 1A60     		str	r2, [r3]
 126:Core/Src/i2c.c **** 		temp = I2C1-> SR2;  //Read SR2 to clear ADDR bit
 402              		.loc 1 126 3 is_stmt 1 view .LVU113
 126:Core/Src/i2c.c **** 		temp = I2C1-> SR2;  //Read SR2 to clear ADDR bit
 403              		.loc 1 126 14 is_stmt 0 view .LVU114
 404 0030 5A69     		ldr	r2, [r3, #20]
 126:Core/Src/i2c.c **** 		temp = I2C1-> SR2;  //Read SR2 to clear ADDR bit
 405              		.loc 1 126 8 view .LVU115
 406 0032 92B2     		uxth	r2, r2
 407 0034 ADF80620 		strh	r2, [sp, #6]	@ movhi
 127:Core/Src/i2c.c **** 
 408              		.loc 1 127 3 is_stmt 1 view .LVU116
 127:Core/Src/i2c.c **** 
 409              		.loc 1 127 14 is_stmt 0 view .LVU117
 410 0038 9B69     		ldr	r3, [r3, #24]
 127:Core/Src/i2c.c **** 
 411              		.loc 1 127 8 view .LVU118
 412 003a 9BB2     		uxth	r3, r3
 413 003c ADF80630 		strh	r3, [sp, #6]	@ movhi
 129:Core/Src/i2c.c **** 
 414              		.loc 1 129 3 is_stmt 1 view .LVU119
 415 0040 FFF7FEFF 		bl	I2C_Stop
 416              	.LVL12:
 131:Core/Src/i2c.c **** 
 417              		.loc 1 131 3 view .LVU120
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 12


 418              	.L26:
 131:Core/Src/i2c.c **** 
 419              		.loc 1 131 10 discriminator 1 view .LVU121
 131:Core/Src/i2c.c **** 
 420              		.loc 1 131 16 is_stmt 0 discriminator 1 view .LVU122
 421 0044 224B     		ldr	r3, .L34
 422 0046 5B69     		ldr	r3, [r3, #20]
 131:Core/Src/i2c.c **** 
 423              		.loc 1 131 10 discriminator 1 view .LVU123
 424 0048 13F0400F 		tst	r3, #64
 425 004c FAD0     		beq	.L26
 133:Core/Src/i2c.c **** 
 426              		.loc 1 133 3 is_stmt 1 view .LVU124
 133:Core/Src/i2c.c **** 
 427              		.loc 1 133 25 is_stmt 0 view .LVU125
 428 004e 204B     		ldr	r3, .L34
 429 0050 1B69     		ldr	r3, [r3, #16]
 133:Core/Src/i2c.c **** 
 430              		.loc 1 133 19 view .LVU126
 431 0052 3370     		strb	r3, [r6]
 432              	.LVL13:
 433              	.L23:
 168:Core/Src/i2c.c **** void I2C_Stop(void){
 434              		.loc 1 168 1 view .LVU127
 435 0054 03B0     		add	sp, sp, #12
 436              		.cfi_remember_state
 437              		.cfi_def_cfa_offset 20
 438              		@ sp needed
 439 0056 F0BD     		pop	{r4, r5, r6, r7, pc}
 440              	.LVL14:
 441              	.L24:
 442              		.cfi_restore_state
 138:Core/Src/i2c.c **** 
 443              		.loc 1 138 3 is_stmt 1 view .LVU128
 138:Core/Src/i2c.c **** 
 444              		.loc 1 138 23 is_stmt 0 view .LVU129
 445 0058 6000     		lsls	r0, r4, #1
 138:Core/Src/i2c.c **** 
 446              		.loc 1 138 27 view .LVU130
 447 005a 40F00100 		orr	r0, r0, #1
 138:Core/Src/i2c.c **** 
 448              		.loc 1 138 3 view .LVU131
 449 005e C0B2     		uxtb	r0, r0
 450 0060 FFF7FEFF 		bl	I2C_Address
 451              	.LVL15:
 140:Core/Src/i2c.c **** 			HAL_Delay(100);
 452              		.loc 1 140 3 is_stmt 1 view .LVU132
 117:Core/Src/i2c.c **** 	if (Size==1){
 453              		.loc 1 117 11 is_stmt 0 view .LVU133
 454 0064 2C46     		mov	r4, r5
 140:Core/Src/i2c.c **** 			HAL_Delay(100);
 455              		.loc 1 140 9 view .LVU134
 456 0066 11E0     		b	.L28
 457              	.LVL16:
 458              	.L30:
 141:Core/Src/i2c.c **** 			while (!(I2C1->SR1 & I2C_SR1_RXNE)); //wait until RXNE is set
 459              		.loc 1 141 4 is_stmt 1 view .LVU135
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 13


 460 0068 6420     		movs	r0, #100
 461 006a FFF7FEFF 		bl	HAL_Delay
 462              	.LVL17:
 142:Core/Src/i2c.c **** 			
 463              		.loc 1 142 4 view .LVU136
 464              	.L29:
 142:Core/Src/i2c.c **** 			
 465              		.loc 1 142 11 discriminator 1 view .LVU137
 142:Core/Src/i2c.c **** 			
 466              		.loc 1 142 17 is_stmt 0 discriminator 1 view .LVU138
 467 006e 184B     		ldr	r3, .L34
 468 0070 5B69     		ldr	r3, [r3, #20]
 142:Core/Src/i2c.c **** 			
 469              		.loc 1 142 11 discriminator 1 view .LVU139
 470 0072 13F0400F 		tst	r3, #64
 471 0076 FAD0     		beq	.L29
 144:Core/Src/i2c.c **** 			I2C1-> CR1 |= I2C_CR1_ACK;  // Aknowledge
 472              		.loc 1 144 4 is_stmt 1 view .LVU140
 144:Core/Src/i2c.c **** 			I2C1-> CR1 |= I2C_CR1_ACK;  // Aknowledge
 473              		.loc 1 144 26 is_stmt 0 view .LVU141
 474 0078 154B     		ldr	r3, .L34
 475 007a 1969     		ldr	r1, [r3, #16]
 144:Core/Src/i2c.c **** 			I2C1-> CR1 |= I2C_CR1_ACK;  // Aknowledge
 476              		.loc 1 144 14 view .LVU142
 477 007c 2A1B     		subs	r2, r5, r4
 144:Core/Src/i2c.c **** 			I2C1-> CR1 |= I2C_CR1_ACK;  // Aknowledge
 478              		.loc 1 144 20 view .LVU143
 479 007e B154     		strb	r1, [r6, r2]
 145:Core/Src/i2c.c **** 			rem--;
 480              		.loc 1 145 4 is_stmt 1 view .LVU144
 145:Core/Src/i2c.c **** 			rem--;
 481              		.loc 1 145 8 is_stmt 0 view .LVU145
 482 0080 1A68     		ldr	r2, [r3]
 145:Core/Src/i2c.c **** 			rem--;
 483              		.loc 1 145 15 view .LVU146
 484 0082 42F48062 		orr	r2, r2, #1024
 485 0086 1A60     		str	r2, [r3]
 146:Core/Src/i2c.c **** 
 486              		.loc 1 146 4 is_stmt 1 view .LVU147
 146:Core/Src/i2c.c **** 
 487              		.loc 1 146 7 is_stmt 0 view .LVU148
 488 0088 013C     		subs	r4, r4, #1
 489              	.LVL18:
 146:Core/Src/i2c.c **** 
 490              		.loc 1 146 7 view .LVU149
 491 008a A4B2     		uxth	r4, r4
 492              	.LVL19:
 493              	.L28:
 140:Core/Src/i2c.c **** 			HAL_Delay(100);
 494              		.loc 1 140 14 is_stmt 1 view .LVU150
 495 008c 032C     		cmp	r4, #3
 496 008e EBD8     		bhi	.L30
 497              	.L31:
 150:Core/Src/i2c.c **** 		I2C1 -> CR1 &= ~(I2C_CR1_ACK);  // Sent a NACK
 498              		.loc 1 150 10 discriminator 1 view .LVU151
 150:Core/Src/i2c.c **** 		I2C1 -> CR1 &= ~(I2C_CR1_ACK);  // Sent a NACK
 499              		.loc 1 150 16 is_stmt 0 discriminator 1 view .LVU152
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 14


 500 0090 0F4B     		ldr	r3, .L34
 501 0092 5B69     		ldr	r3, [r3, #20]
 150:Core/Src/i2c.c **** 		I2C1 -> CR1 &= ~(I2C_CR1_ACK);  // Sent a NACK
 502              		.loc 1 150 10 discriminator 1 view .LVU153
 503 0094 13F0040F 		tst	r3, #4
 504 0098 FAD0     		beq	.L31
 151:Core/Src/i2c.c **** 
 505              		.loc 1 151 3 is_stmt 1 view .LVU154
 151:Core/Src/i2c.c **** 
 506              		.loc 1 151 8 is_stmt 0 view .LVU155
 507 009a 0D4B     		ldr	r3, .L34
 508 009c 1A68     		ldr	r2, [r3]
 151:Core/Src/i2c.c **** 
 509              		.loc 1 151 15 view .LVU156
 510 009e 22F48062 		bic	r2, r2, #1024
 511 00a2 1A60     		str	r2, [r3]
 153:Core/Src/i2c.c **** 		rem--;
 512              		.loc 1 153 3 is_stmt 1 view .LVU157
 153:Core/Src/i2c.c **** 		rem--;
 513              		.loc 1 153 25 is_stmt 0 view .LVU158
 514 00a4 1A69     		ldr	r2, [r3, #16]
 153:Core/Src/i2c.c **** 		rem--;
 515              		.loc 1 153 13 view .LVU159
 516 00a6 2B1B     		subs	r3, r5, r4
 153:Core/Src/i2c.c **** 		rem--;
 517              		.loc 1 153 19 view .LVU160
 518 00a8 F254     		strb	r2, [r6, r3]
 154:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_BTF)); //wait until BTF is set
 519              		.loc 1 154 3 is_stmt 1 view .LVU161
 154:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_BTF)); //wait until BTF is set
 520              		.loc 1 154 6 is_stmt 0 view .LVU162
 521 00aa 671E     		subs	r7, r4, #1
 522 00ac BFB2     		uxth	r7, r7
 523              	.LVL20:
 155:Core/Src/i2c.c **** 		I2C_Stop();
 524              		.loc 1 155 3 is_stmt 1 view .LVU163
 525              	.L32:
 155:Core/Src/i2c.c **** 		I2C_Stop();
 526              		.loc 1 155 10 discriminator 1 view .LVU164
 155:Core/Src/i2c.c **** 		I2C_Stop();
 527              		.loc 1 155 16 is_stmt 0 discriminator 1 view .LVU165
 528 00ae 084B     		ldr	r3, .L34
 529 00b0 5B69     		ldr	r3, [r3, #20]
 155:Core/Src/i2c.c **** 		I2C_Stop();
 530              		.loc 1 155 10 discriminator 1 view .LVU166
 531 00b2 13F0040F 		tst	r3, #4
 532 00b6 FAD0     		beq	.L32
 156:Core/Src/i2c.c **** 
 533              		.loc 1 156 3 is_stmt 1 view .LVU167
 534 00b8 FFF7FEFF 		bl	I2C_Stop
 535              	.LVL21:
 158:Core/Src/i2c.c **** 
 536              		.loc 1 158 3 view .LVU168
 158:Core/Src/i2c.c **** 
 537              		.loc 1 158 25 is_stmt 0 view .LVU169
 538 00bc 044A     		ldr	r2, .L34
 539 00be 1369     		ldr	r3, [r2, #16]
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 15


 158:Core/Src/i2c.c **** 
 540              		.loc 1 158 13 view .LVU170
 541 00c0 EF1B     		subs	r7, r5, r7
 542              	.LVL22:
 158:Core/Src/i2c.c **** 
 543              		.loc 1 158 19 view .LVU171
 544 00c2 F355     		strb	r3, [r6, r7]
 160:Core/Src/i2c.c **** 		// Read Last Byte
 545              		.loc 1 160 3 is_stmt 1 view .LVU172
 160:Core/Src/i2c.c **** 		// Read Last Byte
 546              		.loc 1 160 6 is_stmt 0 view .LVU173
 547 00c4 A31E     		subs	r3, r4, #2
 548 00c6 9BB2     		uxth	r3, r3
 549              	.LVL23:
 163:Core/Src/i2c.c **** 
 550              		.loc 1 163 3 is_stmt 1 view .LVU174
 163:Core/Src/i2c.c **** 
 551              		.loc 1 163 25 is_stmt 0 view .LVU175
 552 00c8 1269     		ldr	r2, [r2, #16]
 163:Core/Src/i2c.c **** 
 553              		.loc 1 163 13 view .LVU176
 554 00ca ED1A     		subs	r5, r5, r3
 163:Core/Src/i2c.c **** 
 555              		.loc 1 163 19 view .LVU177
 556 00cc 7255     		strb	r2, [r6, r5]
 168:Core/Src/i2c.c **** void I2C_Stop(void){
 557              		.loc 1 168 1 view .LVU178
 558 00ce C1E7     		b	.L23
 559              	.L35:
 560              		.align	2
 561              	.L34:
 562 00d0 00540040 		.word	1073763328
 563              		.cfi_endproc
 564              	.LFE134:
 566              		.section	.text.I2C_Mem_Read,"ax",%progbits
 567              		.align	1
 568              		.global	I2C_Mem_Read
 569              		.syntax unified
 570              		.thumb
 571              		.thumb_func
 573              	I2C_Mem_Read:
 574              	.LVL24:
 575              	.LFB136:
 174:Core/Src/i2c.c **** /**
 175:Core/Src/i2c.c ****   * @brief  Reads from specified Memory Address for I2C Device using Repeated Start
 176:Core/Src/i2c.c ****   *         Memory size atmost 2 bytes but can be extended easily to 4 bytes
 177:Core/Src/i2c.c ****   * @param  address : 7bit address of I2C Device
 178:Core/Src/i2c.c ****   * @param  Address:  Memory address to read from on a device
 179:Core/Src/i2c.c ****   * @param  Mem_Size: Size of memory address
 180:Core/Src/i2c.c ****   * @param  pData:     pointer to Data buffer
 181:Core/Src/i2c.c ****   * @param  Size:    Number of bytes to read from Device
 182:Core/Src/i2c.c ****   * @retval None
 183:Core/Src/i2c.c ****   */
 184:Core/Src/i2c.c **** void I2C_Mem_Read(uint8_t address,uint16_t Address,uint16_t Mem_Size,uint8_t *pData,uint16_t Size){
 576              		.loc 1 184 99 is_stmt 1 view -0
 577              		.cfi_startproc
 578              		@ args = 4, pretend = 0, frame = 0
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 16


 579              		@ frame_needed = 0, uses_anonymous_args = 0
 580              		.loc 1 184 99 is_stmt 0 view .LVU180
 581 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 582              		.cfi_def_cfa_offset 24
 583              		.cfi_offset 3, -24
 584              		.cfi_offset 4, -20
 585              		.cfi_offset 5, -16
 586              		.cfi_offset 6, -12
 587              		.cfi_offset 7, -8
 588              		.cfi_offset 14, -4
 589 0002 0746     		mov	r7, r0
 590 0004 1D46     		mov	r5, r3
 591 0006 BDF81860 		ldrh	r6, [sp, #24]
 185:Core/Src/i2c.c **** 	if (Mem_Size==1){
 592              		.loc 1 185 2 is_stmt 1 view .LVU181
 593              		.loc 1 185 5 is_stmt 0 view .LVU182
 594 000a 012A     		cmp	r2, #1
 595 000c 0BD0     		beq	.L43
 596 000e 1446     		mov	r4, r2
 597              	.LBB2:
 186:Core/Src/i2c.c **** 		uint8_t temp = (uint8_t) Address;
 187:Core/Src/i2c.c **** 		pData[0] = temp;
 188:Core/Src/i2c.c **** 		I2C1_Start(); 
 189:Core/Src/i2c.c **** 		I2C_Address(address<<1); //Write Condition
 190:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_TXE)); //wait until RXNE is set
 191:Core/Src/i2c.c **** 		I2C1 -> DR = pData[0];
 192:Core/Src/i2c.c **** 		
 193:Core/Src/i2c.c **** 	}
 194:Core/Src/i2c.c **** 	else{
 195:Core/Src/i2c.c **** 			pData[0] = (uint8_t) (Address >>8);
 598              		.loc 1 195 4 is_stmt 1 view .LVU183
 599              		.loc 1 195 15 is_stmt 0 view .LVU184
 600 0010 0B0A     		lsrs	r3, r1, #8
 601              	.LVL25:
 602              		.loc 1 195 13 view .LVU185
 603 0012 2B70     		strb	r3, [r5]
 196:Core/Src/i2c.c **** 			pData[1] = (uint8_t) (Address&0xFF);
 604              		.loc 1 196 4 is_stmt 1 view .LVU186
 605              		.loc 1 196 13 is_stmt 0 view .LVU187
 606 0014 6970     		strb	r1, [r5, #1]
 197:Core/Src/i2c.c **** 			uint16_t rem = Mem_Size;
 607              		.loc 1 197 4 is_stmt 1 view .LVU188
 608              	.LVL26:
 198:Core/Src/i2c.c **** 			I2C1_Start();
 609              		.loc 1 198 4 view .LVU189
 610 0016 FFF7FEFF 		bl	I2C1_Start
 611              	.LVL27:
 199:Core/Src/i2c.c **** 			I2C_Address(address<<1); //Write Condition
 612              		.loc 1 199 4 view .LVU190
 613 001a 7800     		lsls	r0, r7, #1
 614 001c 00F0FE00 		and	r0, r0, #254
 615 0020 FFF7FEFF 		bl	I2C_Address
 616              	.LVL28:
 200:Core/Src/i2c.c **** 			while (rem){
 617              		.loc 1 200 4 view .LVU191
 618              		.loc 1 200 10 is_stmt 0 view .LVU192
 619 0024 1BE0     		b	.L40
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 17


 620              	.LVL29:
 621              	.L43:
 622              		.loc 1 200 10 view .LVU193
 623              	.LBE2:
 624              	.LBB3:
 186:Core/Src/i2c.c **** 		pData[0] = temp;
 625              		.loc 1 186 3 is_stmt 1 view .LVU194
 187:Core/Src/i2c.c **** 		I2C1_Start(); 
 626              		.loc 1 187 3 view .LVU195
 187:Core/Src/i2c.c **** 		I2C1_Start(); 
 627              		.loc 1 187 12 is_stmt 0 view .LVU196
 628 0026 1970     		strb	r1, [r3]
 188:Core/Src/i2c.c **** 		I2C_Address(address<<1); //Write Condition
 629              		.loc 1 188 3 is_stmt 1 view .LVU197
 630 0028 FFF7FEFF 		bl	I2C1_Start
 631              	.LVL30:
 189:Core/Src/i2c.c **** 		while (!(I2C1->SR1 & I2C_SR1_TXE)); //wait until RXNE is set
 632              		.loc 1 189 3 view .LVU198
 633 002c 7800     		lsls	r0, r7, #1
 634 002e 00F0FE00 		and	r0, r0, #254
 635 0032 FFF7FEFF 		bl	I2C_Address
 636              	.LVL31:
 190:Core/Src/i2c.c **** 		I2C1 -> DR = pData[0];
 637              		.loc 1 190 3 view .LVU199
 638              	.L38:
 190:Core/Src/i2c.c **** 		I2C1 -> DR = pData[0];
 639              		.loc 1 190 10 discriminator 1 view .LVU200
 190:Core/Src/i2c.c **** 		I2C1 -> DR = pData[0];
 640              		.loc 1 190 16 is_stmt 0 discriminator 1 view .LVU201
 641 0036 0E4B     		ldr	r3, .L44
 642 0038 5B69     		ldr	r3, [r3, #20]
 190:Core/Src/i2c.c **** 		I2C1 -> DR = pData[0];
 643              		.loc 1 190 10 discriminator 1 view .LVU202
 644 003a 13F0800F 		tst	r3, #128
 645 003e FAD0     		beq	.L38
 191:Core/Src/i2c.c **** 		
 646              		.loc 1 191 3 is_stmt 1 view .LVU203
 191:Core/Src/i2c.c **** 		
 647              		.loc 1 191 21 is_stmt 0 view .LVU204
 648 0040 2A78     		ldrb	r2, [r5]	@ zero_extendqisi2
 191:Core/Src/i2c.c **** 		
 649              		.loc 1 191 14 view .LVU205
 650 0042 0B4B     		ldr	r3, .L44
 651 0044 1A61     		str	r2, [r3, #16]
 652              	.LVL32:
 191:Core/Src/i2c.c **** 		
 653              		.loc 1 191 14 view .LVU206
 654              	.LBE3:
 655 0046 0CE0     		b	.L39
 656              	.LVL33:
 657              	.L41:
 658              	.LBB4:
 201:Core/Src/i2c.c **** 				while (!(I2C1->SR1 & I2C_SR1_TXE)); 
 659              		.loc 1 201 12 is_stmt 1 discriminator 1 view .LVU207
 660              		.loc 1 201 18 is_stmt 0 discriminator 1 view .LVU208
 661 0048 0949     		ldr	r1, .L44
 662 004a 4969     		ldr	r1, [r1, #20]
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 18


 663              		.loc 1 201 12 discriminator 1 view .LVU209
 664 004c 11F0800F 		tst	r1, #128
 665 0050 FAD0     		beq	.L41
 202:Core/Src/i2c.c **** 				I2C1 -> DR = pData[Size-rem];
 666              		.loc 1 202 5 is_stmt 1 view .LVU210
 667              		.loc 1 202 28 is_stmt 0 view .LVU211
 668 0052 331B     		subs	r3, r6, r4
 669              		.loc 1 202 23 view .LVU212
 670 0054 EA5C     		ldrb	r2, [r5, r3]	@ zero_extendqisi2
 671              		.loc 1 202 16 view .LVU213
 672 0056 064B     		ldr	r3, .L44
 673 0058 1A61     		str	r2, [r3, #16]
 203:Core/Src/i2c.c **** 				rem--;
 674              		.loc 1 203 5 is_stmt 1 view .LVU214
 675              		.loc 1 203 8 is_stmt 0 view .LVU215
 676 005a 013C     		subs	r4, r4, #1
 677              	.LVL34:
 678              		.loc 1 203 8 view .LVU216
 679 005c A4B2     		uxth	r4, r4
 680              	.LVL35:
 681              	.L40:
 200:Core/Src/i2c.c **** 				while (!(I2C1->SR1 & I2C_SR1_TXE)); 
 682              		.loc 1 200 11 is_stmt 1 view .LVU217
 683 005e 002C     		cmp	r4, #0
 684 0060 F2D1     		bne	.L41
 685              	.LVL36:
 686              	.L39:
 200:Core/Src/i2c.c **** 				while (!(I2C1->SR1 & I2C_SR1_TXE)); 
 687              		.loc 1 200 11 is_stmt 0 view .LVU218
 688              	.LBE4:
 204:Core/Src/i2c.c **** 			}
 205:Core/Src/i2c.c **** 
 206:Core/Src/i2c.c **** 	}
 207:Core/Src/i2c.c **** 	I2C_Master_Recieve(address, pData, Size);
 689              		.loc 1 207 2 is_stmt 1 view .LVU219
 690 0062 3246     		mov	r2, r6
 691 0064 2946     		mov	r1, r5
 692 0066 3846     		mov	r0, r7
 693 0068 FFF7FEFF 		bl	I2C_Master_Recieve
 694              	.LVL37:
 208:Core/Src/i2c.c **** 
 209:Core/Src/i2c.c **** }
 695              		.loc 1 209 1 is_stmt 0 view .LVU220
 696 006c F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 697              	.LVL38:
 698              	.L45:
 699              		.loc 1 209 1 view .LVU221
 700 006e 00BF     		.align	2
 701              	.L44:
 702 0070 00540040 		.word	1073763328
 703              		.cfi_endproc
 704              	.LFE136:
 706              		.text
 707              	.Letext0:
 708              		.file 2 "c:\\users\\david\\appdata\\roaming\\code\\user\\globalstorage\\bmd.stm32-for-vscode\\@xpa
 709              		.file 3 "c:\\users\\david\\appdata\\roaming\\code\\user\\globalstorage\\bmd.stm32-for-vscode\\@xpa
 710              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f411xe.h"
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 19


 711              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
ARM GAS  C:\Users\David\AppData\Local\Temp\ccoCV37d.s 			page 20


DEFINED SYMBOLS
                            *ABS*:0000000000000000 i2c.c
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:21     .text.I2C1_Init:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:27     .text.I2C1_Init:0000000000000000 I2C1_Init
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:112    .text.I2C1_Init:0000000000000064 $d
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:119    .text.I2C1_Start:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:125    .text.I2C1_Start:0000000000000000 I2C1_Start
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:166    .text.I2C1_Start:0000000000000024 $d
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:171    .text.I2C_Address:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:177    .text.I2C_Address:0000000000000000 I2C_Address
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:227    .text.I2C_Address:000000000000002c $d
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:232    .text.I2C_Stop:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:238    .text.I2C_Stop:0000000000000000 I2C_Stop
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:257    .text.I2C_Stop:000000000000000c $d
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:262    .text.I2C_Master_Transmit:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:268    .text.I2C_Master_Transmit:0000000000000000 I2C_Master_Transmit
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:338    .text.I2C_Master_Transmit:000000000000003c $d
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:343    .text.I2C_Master_Recieve:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:349    .text.I2C_Master_Recieve:0000000000000000 I2C_Master_Recieve
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:562    .text.I2C_Master_Recieve:00000000000000d0 $d
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:567    .text.I2C_Mem_Read:0000000000000000 $t
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:573    .text.I2C_Mem_Read:0000000000000000 I2C_Mem_Read
C:\Users\David\AppData\Local\Temp\ccoCV37d.s:702    .text.I2C_Mem_Read:0000000000000070 $d

UNDEFINED SYMBOLS
HAL_Delay
